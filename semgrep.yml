rules:
  - id: insecure-subprocess
    pattern: subprocess.run($CMD, shell=True)
    message: "Using subprocess with shell=True can be dangerous."
    severity: ERROR
    languages: [python]  # Spécification du langage ici

  - id: sql-injection
    pattern: "cursor.execute(f'SELECT * FROM users WHERE id = { $USER_ID }')"
    message: "Possible SQL injection vulnerability."
    severity: CRITICAL
    languages: [python]  # Spécification du langage ici

  - id: exec-use
    pattern: exec($CODE)
    message: "Using exec with untrusted input can allow arbitrary code execution."
    severity: HIGH
    languages: [python]  # Spécification du langage ici

  - id: unsafe-import
    pattern: exec(f"import $PACKAGE")
    message: "Executing imports dynamically can lead to code injection vulnerabilities."
    severity: HIGH
    languages: [python]  # Spécification du langage ici

